# 如何高效制作完美插入 Word 的流程图：从 SVG 文字丢失到一站式解决方案

最近在写论文/报告时，需要插入大量流程图、序列图之类的图表。一开始我选择了 Mermaid（因为代码简单、易读），用 Mermaid Chart 在线编辑并导出 SVG，结果插入 Word 后发现**文字全没了**，只剩下孤零零的框和箭头，差点崩溃。

这篇文章记录了我从最初的坑一步步爬出来，最终找到一个**高效、可靠、几乎零问题**的完整流程。整个过程解决了 SVG 在 Word 中的兼容性问题，同时兼顾了快速生成和精细调整的需求。希望能帮到同样被 Word SVG 渲染折磨的朋友。

### 最初的问题：Word 插入 SVG 为何显示不全（尤其是文字消失）

我用 Mermaid Chart 导出 SVG，插入 Word 后：
- 形状和箭头勉强可见（有时线条还透明，需要手动改轮廓颜色）
- **文字完全丢失**，尤其是多行文本或带样式的节点

原因：Mermaid 默认用 `<foreignObject>` 标签嵌入 HTML 来渲染复杂文字，而 Microsoft Word 的 SVG 渲染引擎不支持这个特性，导致文字直接被忽略。

尝试过的临时方案：
- 手动改线条颜色（治标不治本）
- 转 EMF（用 Inkscape 转换，文字能恢复，但操作麻烦）
- 导出 PNG（显示完美，但失去矢量优势）

这些方案要么麻烦，要么牺牲质量，我需要一个更优雅的办法。

### 最终解决方案：AI + Mermaid + draw.io 的黄金流程

经过反复尝试，我总结出了目前最舒服的流程，基本步骤如下：

#### 步骤 1：用 AI 快速生成 Mermaid 代码
- 直接告诉 AI 你想要的图表结构（例如：“帮我画一个用户登录的流程图，包括前端、后端、数据库交互”）
- AI 会输出完整的 Mermaid 代码，基本可用率极高，省去了自己查语法的时间。

#### 步骤 2：在 Mermaid Chart（或 mermaid.live）可视化预览
- 把 AI 生成的代码粘贴到 https://www.mermaidchart.com/ 或 https://mermaid.live
- 实时查看效果，确认逻辑、布局是否正确
- 如有小问题（文字太长、布局拥挤），在这里微调代码即可
![[Pasted image 20251229130237.png]]
可以实时查看,实时编辑
#### 步骤 3：复制代码到 draw.io（diagrams.net）进行精细调整
- 打开 https://app.diagrams.net/
- 你也可以下载客户端 : [Release 29.0.3 · jgraph/drawio-desktop · GitHub](https://github.com/jgraph/drawio-desktop/releases/tag/v29.0.3)
- 点击 Arrange(调整图形) → Insert(插入) → Mermaid（或工具栏 + → Mermaid）
- 粘贴代码，选择插入方式：
  - 推荐 **Image** 模式：生成 SVG 图片，双击即可重新编辑代码，修改后实时更新
  - 如果需要深度改样式，可选 **Diagram** 模式，转换为 draw.io 原生形状，手动拖拽、改色、加注释更自由
- draw.io 的优势：支持手动调整位置、添加额外元素、统一风格，完全弥补 Mermaid 布局不够灵活的短板
![[Pasted image 20251229130410.png]]
![[Pasted image 20251229130516.png]]
#### 步骤 4：直接从 draw.io 导出 SVG 插入 Word
- 调整完成后：File → Export as → SVG
- 在 Word 中“插入 → 图片 → 此设备”选择导出的 SVG 文件
- **结果：文字完整、线条清晰、矢量无失真、放大不模糊**
- 因为 draw.io 生成的 SVG 使用纯路径 + 文本渲染，不依赖 foreignObject，所以 Word 完美支持
![[Pasted image 20251229130557.png]]
![[Pasted image 20251229130610.png]]
### 这个流程的核心优势

| 环节          | 工具                | 解决的问题                          | 优势                              |
|---------------|---------------------|-------------------------------------|-----------------------------------|
| 代码生成      | AI（如 Grok、ChatGPT）| 从零开始写 Mermaid 语法麻烦         | 几秒出初稿，逻辑准确              |
| 预览检查      | Mermaid Chart       | 代码错误难发现                      | 实时渲染，布局一目了然            |
| 精细编辑      | draw.io             | Mermaid 布局固定、调整困难          | 手动拖拽、改样式、加元素，自由度高|
| 导出插入 Word | draw.io SVG         | 原生 Mermaid SVG 文字丢失           | 完美兼容 Word，矢量清晰           |

整个流程从需求到最终插入 Word，最快只需几分钟，却能得到专业级效果。

### 写在最后

从一开始被 Word SVG 文字丢失逼疯，到现在形成这个稳定高效的闭环流程，感觉像是打通了任督二脉。以后再也不用为“图表插进 Word 后又坏了”而加班返工了。

强烈推荐大家试试这个组合：
**AI 生成 → Mermaid Chart 预览 → draw.io 调整 → 导出 SVG 插入 Word**

如果你也在为流程图、架构图、时序图发愁，赶紧收藏这套流程吧，绝对能节省大量时间和精力！

（欢迎在评论区分享你的画图工具链，也许还有更优解～）